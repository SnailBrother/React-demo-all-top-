CREATE TABLE reactDemoApp.dbo.userAccounts (
    id INT IDENTITY(1,1) PRIMARY KEY,         -- 用户ID，自增
    name NVARCHAR(100) NOT NULL,               -- 用户姓名
    email NVARCHAR(100) NOT NULL UNIQUE,       -- 用户邮箱，唯一
    password NVARCHAR(255) NOT NULL,           -- 用户密码，存储加密后的密码
    registration_date DATETIME DEFAULT GETDATE(),  -- 用户注册时间，默认为当前时间
    last_login_time DATETIME,                  -- 最后登录时间
    profile_picture NVARCHAR(255),             -- 头像图片链接
    permission_level NVARCHAR(50),             -- 权限级别，例如管理员、普通用户、VIP等  
    is_locked BIT DEFAULT 0,                    -- 账户锁定状态，默认为0（未锁定）
    notes NVARCHAR(500)                       -- 管理员备注信息
);

const express = require('express');
const cors = require('cors');
const sql = require('mssql');
const xlsx = require('xlsx');
const app = express();
const port = 4200;


// SQL Server 配置
const config = {
    user: 'sa',
    password: 'Alan944926',
    server: '111.231.79.183',
    database: 'reactDemoApp',
    options: {
        encrypt: false,
        trustServerCertificate: true,
        pool: {
            max: 100, // 连接池最大连接数
            min: 0,  // 最小连接数
            idleTimeoutMillis: 30000 // 空闲连接超时时间
        }

    }
};

  const response = await fetch('http://111.231.79.183:4200/api/getUserAccounts');

// 获取 userAccounts 表数据
app.get('/api/getUserAccounts', async (req, res) => {
    try {
        let firstpool = await sql.connect(config);
        let accountLoginResult = await firstpool.request().query('SELECT * FROM reactDemoApp.dbo.userAccounts');
        res.json({ AccountLogin: accountLoginResult.recordset });
        firstpool.close();
    } catch (err) {
        console.error(err);
        res.status(500).send('Server Error');
    }
});